\chapter{Perturbing the lattice}

In this chapter we will study how introducing an electromagnetic perturbation in \ref{Ham1} can affect the parameters $J$ and $\boldsymbol{D}_{ij}$ of the effective Hamiltonian. 

\begin{section}{Hubbard model without SOI}

We start by considering only the exchange interaction part in a one-dimensional lattice. Consider the Hamiltonian:

\begin{equation}
\hat{H} = -t_0\sum_{\langle i,j \rangle, \sigma} \hat{c}_{i \sigma}^\dagger \hat{c}_{j \sigma} + \text{U} \sum_{i=1}^M \hat{n}_{i\uparrow}\hat{n}_{i\downarrow}
\end{equation}

Which is the Hamiltonian \ref{Hubbard} without DMI interaction. We can introduce a time dependent electric field in this Hamiltonian by adding a phase to the hopping term $t_{ij}(t) = t_0e^{ie\bs{R}_{ij}\bs{A}(t)}$, where $\bs{A}$ is the vector potential and $\bs{R}_{ij} = \bs{R}_i-\bs{R}_j$. This is known as Peierls substitution and it is derived in \ref{AP3A}. We write the electric field as $\bs{E}(t) = \frac{1}{2}(\vec{E}e^{-i\omega t}+\vec{E}^*e^{i\omega t})$, where $\vec{E} = E_0\hat{e}$ and $\hat{e} = \frac{1}{\sqrt{1+\lambda_{POL}^2}}(\hat{e}_x+i\lambda_{POL}\hat{e}_y)$ is the polarization vector and $\lambda_{POL} = 0, \pm 1$ for plane polarized, right handed and left handed circular polarized field respectively. The vector potential takes the form $\bs{A}(t) = \frac{1}{2}(\vec{A}e^{-i\omega t} + \vec{A}^* e^{i\omega t})$, with $\vec{A} = \frac{iE_0}{\omega}\hat{e}$. The time dependent Hamiltonian is:

\begin{equation}
\hat{H}(t) = -\sum_{\langle i,j \rangle, \sigma} t_{ij}(t)\hat{c}_{i \sigma}^\dagger \hat{c}_{j \sigma} + \text{U} \sum_{i=1}^M \hat{n}_{i\uparrow}\hat{n}_{i\downarrow} = -\hat{T}(t) + \text{U}\hat{D}
\end{equation}

Where $\hat{D}$ is the double occupancy number operator and $\hat{T}(t) = \sum_{\langle i,j \rangle, \sigma} t_{ij}(t)\hat{c}_{i \sigma}^\dagger \hat{c}_{j \sigma}$ is the hopping operator. Let $e\bs{R}_{ij}\vec{A} = \alpha_{ij} e^{i \theta_{ij}}$, with $\alpha_{ij}$ a real number, then we can apply the Jacobi–Anger expansion:

\begin{align*}
t_{ij}(t) = t_0e^{ie\bs{R}_{ij}\bs{A}(t)} = t_0e^{i\alpha_{ij} \cos(\omega t - \theta_{ij})} = t_0 \sum_m e^{i(\frac{\pi}{2}-\theta_{ij})m} \mathcal{J}_m(\alpha_{ij}) e^{im\omega t} = \sum t_{ij,m} e^{im\omega t}
\end{align*}

Where $t_{ij,m} = t_0 e^{i(\frac{\pi}{2}-\theta_{ij})m} \mathcal{J}_m(\alpha_{ij})$ and $\mathcal{J}_m(x)$ is the \textit{m}th Bessel function \cite{Kitamura2017}. Correspondingly $\hat{T}(t) = \sum_m \hat{T}_m e^{im \omega t}$.

In order to derive the form of the effective Hamiltonian in the half filling system with $t << \text{U}$ let us introduce a time dependent unitary transformation $\hat{U}(t) = e^{-i\hat{S}(t)}$. The transformed Hamiltonian is:

\begin{equation}
\hat{H}'(t) = \hat{U}^\dagger (t) \hat{H}(t) \hat{U}(t) - i\hat{U}^\dagger(t) d_t \hat{U}(t)
\end{equation} 

We perform the unitary transformation perturbatively in the hopping parameter $t_0$, to that end let us write $\hat{T}(t) = \eta \hat{T}(t)$, where $\eta$ will play the role of a bookkeeping parameter in the perturbative expansion. We expand $\hat{S}(t) = \sum_\nu \eta^\nu \hat{S}^{(\nu)}(t)$ and $\hat{H}'(t) = \sum_\nu \eta^\nu \hat{H}'^{(\nu)}(t)$. In order for the new Hamiltonian to be periodic we impose the unitary transformation to have the periodicity of the Hamiltonian, so that we can expand $\hat{S}^{(\nu)}(t) = \sum_m e^{im\omega t}\hat{S}^{(\nu)}_m$. Additionally we can impose the transformed Hamiltonian to be block diagonal in the doublon number $d$. With these conditions the unitary transformation can be uniquely determined if we impose that $\hat{S}(t)$ does not contain block-diagonal terms, i.e. we can write:

\begin{equation}
\hat{S}^{(\nu)}(t) = \sum_{d \neq 0} \sum_m \eta^\nu \hat{S}^{(\nu)}_{d,m} e^{im\omega t}
\end{equation}

where $\hat{S}^{(\nu)}_{d,m}$ changes the double occupancy number by $d$. We also decompose the hopping operator as:

\begin{equation}
\hat{T}(t) = \eta \sum_m (\hat{T}_{-1,m}+\hat{T}_{0,m}+\hat{T}_{1,m})e^{im\omega t}
\end{equation}

Where $\hat{T}_d(t)$ changes the double occupancy number by $d$, for example $\hat{T}_1(t) = \hat{P}_1 \hat{T}(t) \hat{P}_0$. Using the Baker–Campbell–Hausdorff expansion we can write the transformed Hamiltonian as:

\begin{equation}
\label{Perturbation}
\hat{H}'(t) = \hat{H}(t) + \sum_{n=1}^\infty \frac{1}{n!} \left[i\hat{S}(t), \dots, \left[ i\hat{S}(t), \hat{H}(t) \right]\dots \right] - d_t \hat{S}(t)
\end{equation}

Now, starting from order zero and for each order we will determine $i\hat{S}^{(\nu)}(t)$ so that $\hat{H}'^{(\nu)}(t)$ is diagonal in the doublon number. To zeroth order in $\eta$ we have $\hat{H}'^{(0)}= U\hat{D}$ and $i\hat{S}^{(0)}(t)=0$. In first order we obtain:

\begin{equation}
\label{1stO}
\hat{H}'^{(1)}(t) = -\hat{T}(t) + \left[ i\hat{S}^{(1)}(t), U\hat{D} \right] - d_t\hat{S}^{(1)}(t)
\end{equation}

Now we expanding in $m,d$ and use $\left[ \hat{D}, \hat{S}^{(\nu)}_{dm} \right] = d\hat{S}^{(\nu)}_{dm}$ because $\hat{S}^{(\nu)}_{dm}$ changes the doublon number by $d$:

\begin{equation}
\hat{H}'^{(1)}(t)=-\hat{T}(t)-\sum_{d\neq 0}\sum_m (Ud+m\omega) i\hat{S}^{(1)}_{dm} e^{im\omega t}
\end{equation}

Therefore:

\begin{align}
i\hat{S}^{(1)}_d(t) &= -\sum_m \frac{\hat{T}_{d,m}}{Ud+m\omega}e^{im\omega t} \label{1stOSpin}\\
\hat{H}'^{(1)}(t) &= -\hat{T}_0(t) \label{1stOH}
\end{align}

To second order we find:

\begin{equation}
\hat{H}'^{(2)}(t) = \left[i\hat{S}^{(2)}(t), U \hat{D} \right] - \left[ i\hat{S}^{(1)}(t), \hat{T}(t) \right] + \frac{1}{2}\left[ i\hat{S}^{(1)}(t), \left[ i\hat{S}^{(1)}(t), U\hat{D} \right] \right] - d_t\hat{S}^{(2)}(t)
\end{equation}

Using \ref{1stO} and using $\left[ i\hat{S}^{(1)}(t), d_t\hat{S}^{(1)}(t)\right] = 0$ due to different Fourier modes of the hopping operator being equal up to a constant, we can rewrite:

\begin{equation}
\hat{H}'^{(2)}(t) = \left[i\hat{S}^{(2)}(t), U \hat{D} \right] - \frac{1}{2}\left[ i\hat{S}^{(1)}(t), \hat{T}(t) - \hat{H}'^{(1)}(t)\right] - d_t\hat{S}^{(2)}(t)
\end{equation}

Using \ref{1stOSpin} and \ref{1stOH}, the middle term is:

\begin{align*}
&\left[ i\hat{S}^{(1)}(t), \hat{T}(t) - \hat{H}'^{(1)}(t)\right] = -\left[\sum_m \left( \frac{\hat{T}_{1m}}{U+m\omega} - \frac{\hat{T}_{-1m}}{U-m\omega} \right)e^{im \omega t}, \sum_n \left( \hat{T}_{-1n} + 2\hat{T}_{0n} + \hat{T}_{1n} \right) e^{in\omega t} \right] \\
&= -\sum_{mn} \left\{ \frac{2\left[\hat{T}_{1m}, \hat{T}_{0n} \right]}{U+m\omega} + \frac{\left[\hat{T}_{1m}, \hat{T}_{-1n} \right]}{U+m\omega} - \frac{\left[\hat{T}_{-1m}, \hat{T}_{1n} \right]}{U-m\omega} - \frac{2\left[\hat{T}_{-1m}, \hat{T}_{0n} \right]}{U-m\omega} \right\} e^{i(m+n)\omega t} \\
&= -\sum_{mn} \left\{ \frac{2\left[\hat{T}_{1n}, \hat{T}_{0(m-n)} \right]}{U+n\omega} + \frac{\left[\hat{T}_{1n}, \hat{T}_{-1(m-n)} \right]}{U+n\omega} - \frac{\left[\hat{T}_{-1n}, \hat{T}_{1(m-n)} \right]}{U-n\omega} - \frac{2\left[\hat{T}_{-1n}, \hat{T}_{0(m-n)} \right]}{U-n\omega} \right\} e^{im\omega t}
\end{align*}

Altogether:

\begin{align*}
\hat{H}'^{(2)}(t) &= \sum_{mn} \left\{ \frac{\left[\hat{T}_{1n}, \hat{T}_{0(m-n)} \right]}{U+n\omega} + \frac{\left[\hat{T}_{1n}, \hat{T}_{-1(m-n)} \right]}{2(U+n\omega)} - \frac{\left[\hat{T}_{-1n}, \hat{T}_{1(m-n)} \right]}{2(U-n\omega)} - \frac{\left[\hat{T}_{-1n}, \hat{T}_{0(m-n)} \right]}{U-n\omega} \right\} e^{im\omega t} \\
&-\sum_{d\neq 0}\sum_m (Ud+m\omega) i\hat{S}^{(2)}_{dm} e^{im\omega t}
\end{align*}

We obtain:

\begin{align}
i\hat{S}^{(2)}_{dm} &= \sum_n \frac{\left[ \hat{T}_{dn}, \hat{T}_{0(m-n)} \right]}{(Ud+n\omega)(Ud+m\omega)} \label{2ndOSpin}\\
\hat{H}'^{(2)}(t) &= \frac{1}{2}\sum_{mn} \left( \frac{\left[\hat{T}_{1n}, \hat{T}_{-1(m-n)} \right]}{U+n\omega} - \frac{\left[\hat{T}_{-1n}, \hat{T}_{1(m-n)} \right]}{U-n\omega} \right) e^{im\omega t} \label{2ndOH}
\end{align}

Now the effective Hamiltonian acts on the subspace of $\hat{P}_0$, therefore we are only interested on $\hat{P}_0 \hat{H}'^{(2)}(t) \hat{P}_0$ (notice that $\hat{P}_0 \hat{H}'^{(1)}(t) \hat{P}_0 = 0$). In this subspace we can write:

\begin{align*}
\hat{T}_{1n} \hat{T}_{-1(m-n)} &= 0 \\
\hat{T}_{-1(m-n)} \hat{T}_{1n} &= \sum_{\langle i,j \rangle, \sigma_1, \sigma_2} t_{ji,(m-n)} t_{ij,n} \hat{c}_{j \sigma_2}^\dagger \hat{c}_{i \sigma_2} \hat{c}_{i \sigma_1}^\dagger \hat{c}_{j \sigma_1}
\end{align*}

So that,

\begin{equation}
\hat{H}_{eff}(t) = \hat{P}_0\hat{H}'^{(2)}(t)\hat{P}_0 = - \frac{1}{2}\sum_{mn} \sum_{\langle i,j \rangle, \sigma_1, \sigma_2}\hat{c}_{j \sigma_2}^\dagger \hat{c}_{i \sigma_2} \hat{c}_{i \sigma_1}^\dagger \hat{c}_{j \sigma_1} \left( \frac{t_{ji,(m-n)} t_{ij,n}}{U+n\omega} + \frac{t_{ji,n} t_{ij,(m-n)}}{U-n\omega} \right) e^{im\omega t}
\end{equation}

Comparing with \ref{PertNoEMF} we can see that this will lead to a spin Hamiltonian 

\begin{equation}
\hat{H}_{eff}(t) = \sum_{\langle i,j \rangle} J_{ij}(t) \bs{S}_i \bs{S}_j
\end{equation}

With 

\begin{align}
J_{ij}(t) &= \sum_{mn} \left( \frac{t_{ji,(m-n)} t_{ij,n}}{U+n\omega} + \frac{t_{ji,n} t_{ij,(m-n)}}{U-n\omega} \right) e^{im\omega t} \nonumber \\
&= \sum_{mn} \left( \frac{t_{ji,(m-n)} t_{ij,n} + t_{ji,-n} t_{ij,(m+n)}}{U+n\omega} \right) e^{im\omega t} \label{Jij1}
\end{align}

Now, $t_{ij,m} = t_0 e^{i(\frac{\pi}{2}-\theta_{ij})m} \mathcal{J}_m(\alpha_{ij})$, using that $\theta_{ji} = \theta_{ij}$ and $\alpha_{ji} = -\alpha_{ij}$ and the properties $\mathcal{J}_{-m}(x) = (-1)^m\mathcal{J}_m(x)$ and $\mathcal{J}_m(-x) = (-1)^m\mathcal{J}_m(x)$ we can write \ref{Jij1} as:

\begin{equation}
J_{ij}(t) = \sum_{mn} t_0^2 e^{i(\frac{\pi}{2}-\theta_{ij})m}\left(\frac{\mathcal{J}_{n-m}(\alpha_{ij})\mathcal{J}_{n}(\alpha_{ij})+\mathcal{J}_{n}(\alpha_{ij})\mathcal{J}_{n+m}(\alpha_{ij})}{U+n\omega} \right) e^{im\omega t}
\end{equation}

After time average this reduces to the $m=0$ term:

\begin{equation}
\label{Jij2}
J_{ij}(t) = \sum_{n} 2t_0^2 \frac{\mathcal{J}_n(\alpha_{ij})^2}{U+n\omega}
\end{equation}

Now, $\alpha_{ij} = \text{Re}(e\bs{R}_{ij}\vec{A})$. For a square lattices aligned with the coordinate system so that $\vec{a}_1=\hat{e}_x$ and $\vec{a}_2=\hat{e}_y$, we will have $\bs{R}_{ij} = \pm a\hat{e}_x,\pm a\hat{e}_y$, where $a$ is the lattice constant. Using $\vec{A}=\frac{iE_0}{\omega\sqrt{1+\lambda^2}}(\hat{e}_x+i\lambda\hat{e}_y)$ we have:

\begin{equation}
\alpha_{ij} = \begin{cases}
             \pm \frac{eaE_0}{\omega \sqrt{1+\lambda^2}} = \pm \frac{\mathcal{E}}{\sqrt{1+\lambda^2}},  & \text{for } \bs{R}_{ij} = \pm \hat{e}_x \\
             \pm \lambda\frac{eaE_0}{\omega \sqrt{1+\lambda^2}} = \pm \frac{\lambda \mathcal{E}}{\sqrt{1+\lambda^2}},  & \text{for } \bs{R}_{ij} = \pm \hat{e}_y
       \end{cases} \quad
\end{equation}

Where $\mathcal{E} = \frac{eaE_0}{\omega}$. For $\omega>>U$ we can take only the three smallest values of $n$, i.e. $n=0, \pm 1$ in \ref{Jij2} as an approximation. We can also use that $\alpha_{ij} << 1$ since $\omega$ appears in the denominator and so $J_n(x) \approx x^n \text{ for } n>0 \text{ and } x << 1$:

\begin{equation}
J_{ij} = 2t_0^2 \left(\frac{\alpha_{ij}^2}{U+\omega} +\frac{1}{U} +\frac{\alpha_{ij}^2}{U-\omega} \right) = J_{ij}^0 + 2t_0^2 \alpha_{ij}^2 \left( \frac{1}{U+\omega} + \frac{1}{U-\omega} \right)
\end{equation}

For plane polarized light ($\lambda = 0$) the exchange interaction only changes in the direction of the polarization, that is:

\begin{equation}
J_{ij}^{PP} = \begin{cases}
		J_{ij}^0 + 2t_0^2 \mathcal{E}^2 \left( \frac{1}{U+\omega} + \frac{1}{U-\omega} \right) & \text{for } \bs{R}_{ij} = \pm \hat{e}_x \\
J_{ij}^0 & \text{for } \bs{R}_{ij} = \pm \hat{e}_y
\end{cases} \quad 
\end{equation}

For circular polarized light ($\lambda=\pm1$) in this approximation the exchange interaction changes in the same way in all the directions:

\begin{equation}
J_{ij}^{CP} = J_{ij}^0 + t_0^2 \mathcal{E}^2 \left( \frac{1}{U+\omega} + \frac{1}{U-\omega} \right)
\end{equation}

\end{section}

\begin{section}{Hubbard model with SOI}

Now, let's investigate the effect of the electric field for the Hubbard model with SOI. As seen in \ref{AP3A} we can use the Peierls substitution to obtain the Hamiltonian:

\begin{equation}
\hat{H}(t) = -\sum_{\langle i,j \rangle, \sigma, \sigma'} e^{ie\bs{R}_{ij}\bs{A}(t)} (\delta_{\sigma \sigma'}t_0 + \bs{\Delta}_{ij}\bs{\sigma}_{\sigma \sigma'}) \hat{c}_{i \sigma}^\dagger \hat{c}_{j \sigma'} + \text{U} \sum_{i=1}^M \hat{n}_{i\uparrow}\hat{n}_{i\downarrow} = -\hat{T}(t) + \text{U}\hat{D}
\end{equation}

In this case the hopping operator $\hat{T}(t)$ includes the spin orbit interaction, but the time dependence is the same as before, we can use $e^{ie\bs{R}_{ij}\bs{A}(t)} =  \sum_m e^{i(\frac{\pi}{2}-\theta_{ij})m} \mathcal{J}_m(\alpha_{ij}) e^{im\omega t}$ where as before $e\bs{R}_{ij}\vec{A} = \alpha_{ij} e^{i \theta_{ij}}$ to write:

\begin{equation}
\hat{T}(t) = \sum_{\langle i,j \rangle, \sigma, \sigma'} \sum_m \Gamma_{ij,m}^{\sigma\sigma'} e^{im \omega t} \hat{c}_{i \sigma}^\dagger \hat{c}_{j \sigma'}
\end{equation}

Where we define $\Gamma_{ij,m}^{\sigma\sigma'} = e^{i(\frac{\pi}{2}-\theta_{ij})m} \mathcal{J}_m(\alpha_{ij})(\delta_{\sigma, \sigma'}t_0+\bs{\Delta}_{ij}\bs{\sigma}_{\sigma \sigma'})$ a scalar. Now we can follow the same procedure as in the previous section to obtain \ref{2ndOH}

\begin{equation}
\hat{H}'^{(2)}(t) = \frac{1}{2}\sum_{mn} \left( \frac{\left[\hat{T}_{1n}, \hat{T}_{-1(m-n)} \right]}{\text{U}+n\omega} - \frac{\left[\hat{T}_{-1n}, \hat{T}_{1(m-n)} \right]}{\text{U}-n\omega} \right) e^{im\omega t}
\end{equation}

As before, we are only interested on how the Hamiltonian acts on the subspace of doublon number $d=0$. In that subspace we have:

\begin{equation}
\hat{H}_{eff}(t) = \hat{P}_0 \hat{H}'^{(2)}(t)\hat{P}_0 = - \frac{1}{2}\sum_{mn} \left( \frac{\hat{T}_{-1(m-n)}\hat{T}_{1n}  }{\text{U}+n\omega} + \frac{\hat{T}_{-1n}\hat{T}_{1(m-n)}}{\text{U}-n\omega} \right) e^{im\omega t}
\end{equation}

Where,

\begin{equation}
\hat{P}_0 \hat{T}_{-1a}\hat{T}_{1b} \hat{P}_0 = \sum_{\langle i,j \rangle \sigma_1, \sigma_2, \sigma_3, \sigma_4} \Gamma_{ij,a}^{\sigma_1\sigma_2}\Gamma_{ji,b}^{\sigma_3\sigma_4} \hat{c}_{i\sigma_1}^\dagger\hat{c}_{j\sigma_2}\hat{c}_{j\sigma_3}^\dagger\hat{c}_{i\sigma_4}
\end{equation}

For any integers $a,b$. Therefore:

\begin{equation}
\hat{H}_{eff}(t) = -\frac{1}{2}\sum_{mn} \sum_{\langle i,j \rangle \sigma_1, \sigma_2, \sigma_3, \sigma_4} \hat{c}_{i\sigma_1}^\dagger\hat{c}_{j\sigma_2}\hat{c}_{j\sigma_3}^\dagger\hat{c}_{i\sigma_4} \left\{ \frac{\Gamma_{ij,(m-n)}^{\sigma_1\sigma_2}\Gamma_{ji,n}^{\sigma_3\sigma_4}}{\text{U}+n\omega} + \frac{\Gamma_{ij,n}^{\sigma_1\sigma_2}\Gamma_{ji,(m-n)}^{\sigma_3\sigma_4}}{\text{U}-n\omega} \right\} e^{im\omega t}
\end{equation}

We can rewrite:

\begin{align*}
\Gamma_{ij,(m-n)}^{\sigma_1\sigma_2}\Gamma_{ji,n}^{\sigma_3\sigma_4} &= e^{i(\frac{\pi}{2}-\theta_{ij})m}\mathcal{J}_{m-n}(\alpha_{ij})\mathcal{J}_n(\alpha_{ji})(\delta_{\sigma_1, \sigma_2}t_0+\bs{\Delta}_{ij}\bs{\sigma}_{\sigma_1 \sigma_2})(\delta_{\sigma_3, \sigma_4}t_0+\bs{\Delta}_{ji}\bs{\sigma}_{\sigma_3 \sigma_4}) = \\
&= e^{i(\frac{\pi}{2}-\theta_{ij})m}\mathcal{J}_{m-n}(\alpha_{ij})\mathcal{J}_{-n}(\alpha_{ij})(\delta_{\sigma_1, \sigma_2}t_0+\bs{\Delta}_{ij}\bs{\sigma}_{\sigma_1 \sigma_2})(\delta_{\sigma_3, \sigma_4}t_0-\bs{\Delta}_{ij}\bs{\sigma}_{\sigma_3 \sigma_4}) = \\
&= e^{i(\frac{\pi}{2}-\theta_{ij})m}\mathcal{J}_{m-n}(\alpha_{ij})\mathcal{J}_{-n}(\alpha_{ij}) \left[ \delta_{\sigma_1, \sigma_2}\delta_{\sigma_3, \sigma_4}t_0^2+t_0\bs{\Delta}_{ij}(\delta_{\sigma_3,\sigma_4}\bs{\sigma}_{\sigma_1 \sigma_2}-\delta_{\sigma_1,\sigma_2}\bs{\sigma}_{\sigma_3 \sigma_4}) + \mathcal{O}(\bs{\Delta}_{ij}^2) \right]
\end{align*}

Where we used $\theta_{ji} = \theta_{ij}$, $\alpha_{ji} = - \alpha_{ij}$ and $\bs{\Delta}_{ji} = -\bs{\Delta}_{ij}$. We neglect the $\mathcal{O}(\bs{\Delta}_{ij}^2)$ term. The term proportional to $t_0^2$ will lead to the modified exchange interaction, and it is exactly the same as in the previous section. The term proportional to $t_0\bs{\Delta}_{ij}$ will lead to the modified DMI interaction. Define:

\begin{equation}
\mathcal{M}(\alpha_{ij}, \text{U}, \omega, t) = \sum_{mn}e^{i(\frac{\pi}{2}-\theta_{ij})m} \left\{ 
    \frac{\mathcal{J}_{m-n}(\alpha_{ij})\mathcal{J}_{-n}(\alpha_{ij})}{\text{U}+n\omega} +
    \frac{\mathcal{J}_n(\alpha_{ij})\mathcal{J}_{n-m}(\alpha_{ij})}{\text{U}-n\omega}    
    \right\}e^{im\omega t}
\end{equation}

Now, introducing the spin operators \ref{SpinOperators}, using relations \ref{SpinOperatorInv1} and \ref{SpinOperatorInv2} and taking into account that in this subspace $n_{i\uparrow}+n_{i\downarrow}=1$ we obtain:

\begin{align*}
\hat{H}_{eff}(t) &\approx -\frac{1}{2}\sum_{\langle i,j \rangle \sigma_1, \sigma_2, \sigma_3, \sigma_4} \left(\frac{1}{2}\delta_{\sigma_1 \sigma_4} + \bs{S}_i\bs{\sigma}_{\sigma_4 \sigma_1}\right)\left(\frac{1}{2}\delta_{\sigma_2 \sigma_3}-\bs{S}_j\bs{\sigma}_{\sigma_2 \sigma_3}\right) \times \\
&\times \left[ \delta_{\sigma_1, \sigma_2}\delta_{\sigma_3, \sigma_4}t_0^2+t_0\bs{\Delta}_{ij}(\delta_{\sigma_3,\sigma_4}\bs{\sigma}_{\sigma_1 \sigma_2}-\delta_{\sigma_1,\sigma_2}\bs{\sigma}_{\sigma_3 \sigma_4}) \right]\mathcal{M}(\alpha_{ij}, \text{U}, \omega, t) = \\
&= -\frac{t_0^2}{2} \sum_{\langle i,j \rangle \sigma, \sigma'} \left(\frac{1}{2}\delta_{\sigma \sigma'} + \bs{S}_i\bs{\sigma}_{\sigma' \sigma}\right)\left(\frac{1}{2}\delta_{\sigma \sigma'}-\bs{S}_j\bs{\sigma}_{\sigma \sigma'}\right)\mathcal{M}(\alpha_{ij}, \text{U}, \omega, t) - \\
&- \frac{t_0}{2} \sum_{\langle i,j \rangle \sigma_1, \sigma_2, \sigma_3, \sigma_4} \left(\frac{1}{2}\delta_{\sigma_1 \sigma_4} + \bs{S}_i\bs{\sigma}_{\sigma_4 \sigma_1}\right)\left(\frac{1}{2}\delta_{\sigma_2 \sigma_3}-\bs{S}_j\bs{\sigma}_{\sigma_2 \sigma_3}\right) \times \\
&\bs{\Delta}_{ij}(\delta_{\sigma_3,\sigma_4}\bs{\sigma}_{\sigma_1 \sigma_2}-\delta_{\sigma_1,\sigma_2}\bs{\sigma}_{\sigma_3 \sigma_4})\mathcal{M}(\alpha_{ij}, \text{U}, \omega, t) = \\
&= \sum_{\langle i,j \rangle} \left( t_0^2 \bs{S}_i\bs{S}_j + 2it_0\bs{\Delta}_{ij} \bs{S}_i \times \bs{S}_j \right) \mathcal{M}(\alpha_{ij}, \text{U}, \omega, t) =\\
&= \sum_{\langle i,j \rangle} J_{ij}(t)\bs{S}_i\bs{S}_j +\bs{D}_{ij}(t)\bs{S}_i \times \bs{S}_j = \\
&= \hat{H}_J'(t)+\hat{H}_D'(t)
\end{align*}

Where we also used relations \ref{SpinRel1} and \ref{SpinRel2}. We have:

\begin{align}
J_{ij}(t) &= t_0^2\mathcal{M}(\alpha_{ij}, \text{U}, \omega, t) \\
\bs{D}_{ij}(t) &= 2it_0\bs{\Delta}_{ij} \mathcal{M}(\alpha_{ij}, \text{U}, \omega, t)
\end{align}

For $\bs{D}_{ij}(t)$ this is:

\begin{equation}
\bs{D}_{ij} = 2it_0 \bs{\Delta}_{ij} \sum_{mn}e^{i(\frac{\pi}{2}-\theta_{ij})m} \left\{ 
    \frac{\mathcal{J}_{m-n}(\alpha_{ij})\mathcal{J}_{-n}(\alpha_{ij})}{\text{U}+n\omega} +
    \frac{\mathcal{J}_n(\alpha_{ij})\mathcal{J}_{n-m}(\alpha_{ij})}{\text{U}-n\omega}    
    \right\}e^{im\omega t}
\end{equation}

\end{section}

\begin{subappendices}
\begin{section}{Peierls Substitution}
\label{AP3A}

In first quantization we can introduce a vector potential $\bs{A}(\bs{r},t)$ by changing the Hamiltonian of the latice \ref{LaticeHam} to:

\begin{equation}
\label{HamEMF}
  \hat{H}'(\bs{r}) = \frac{(\bs{p}-e\bs{A})^2}{2m} +U(\bs{r})
\end{equation}

Now the Bloch functions defined for \ref{LaticeHam} will not be eigenfunctions of this Hamiltonian. We define a new set of Wannier functions in terms of those defined in \ref{Wannier2}, and obtain the new Bloch functions. 

\begin{align}
\psi'_{\bs{R}}(\bs{r}) &= e^{i\frac{e}{\hbar}\int_{\bs{R}}^{\bs{r}} d\bs{r}'\bs{A}(\bs{r}',t)} \psi_{\bs{R}}(\bs{r}) \\
\phi'_{\bs{k}}(\textbf{r}) &= \frac{1}{\sqrt{M}}\sum_{\bs{R}} e^{-i\bs{k}\bs{R}}\psi'_{\bs{R}}(\bs{r}) = \frac{1}{\sqrt{M}}\sum_{\bs{R}} e^{-i\bs{k}\bs{R}} e^{i\frac{e}{\hbar}\int_{\bs{R}}^{\bs{r}} d\bs{r}'\bs{A}(\bs{r}',t)} \psi_{\bs{R}}(\bs{r})
\end{align}

Where we omitted the band number. The action of the new Hamiltonian is greatly simplified:

\begin{align*}
\hat{H}'(\bs{r}) \psi'_{\bs{R}} (\bs{r}) &= \left[ \frac{(\bs{p}-e\bs{A})^2}{2m} +U(\bs{r}) \right] e^{i\frac{e}{\hbar}\int_{\bs{R}}^{\bs{r}} d\bs{r}'\bs{A}(\bs{r}',t)} \psi_{\bs{R}}(\bs{r}) = \\
&= e^{i\frac{e}{\hbar}\int_{\bs{R}}^{\bs{r}} d\bs{r}'\bs{A}(\bs{r}',t)} \left[ \frac{\bs{p}^2}{2m} + U(\bs{r}) \right] \psi_{\bs{R}}(\bs{r}) = e^{i\frac{e}{\hbar}\int_{\bs{R}}^{\bs{r}} d\bs{r}'\bs{A}(\bs{r}',t)} \hat{H}(\bs{r}) \psi_{\bs{R}}(\bs{r})
\end{align*}

And so, the matrix elements as in the case without field except for a phase:

\begin{equation}
\label{PeierlsMtxElem}
t_{ij}(t) = \bra{\psi'_{\bs{R_i}}} \hat{H}'(\bs{r}) \ket{\psi'_{\bs{R_j}}} = e^{i\frac{e}{\hbar}\int_{\bs{R}_j}^{\bs{R}_i} d\bs{r}'\bs{A}(\bs{r}',t)} \bra{\psi_{\bs{R_i}}} \hat{H}(\bs{r}) \ket{\psi_{\bs{R_j}}}
\end{equation}

When the field can be approximated as constant along the lattice we have: $e^{i\frac{e}{\hbar}\int_{\bs{R}_j}^{\bs{R}_i} d\bs{r}'\bs{A}(\bs{r}',t)} = e^{i\frac{e}{\hbar} (\bs{R}_i-\bs{R}_j) \bs{A}(t)}$.

Notice that this substitution also applies if we add a Rashba Spin-Orbit interaction term to \ref{HamEMF}, i.e., if $\hat{H}'(\bs{r}) = \frac{(\bs{p}-e\bs{A})^2}{2m} +U(\bs{r}) + \alpha_R \hat{z}(\hat{\bs{\sigma}} \times (\bs{p}-e\bs{A}))$, then

\begin{align*}
  \alpha_R \hat{z}(\hat{\bs{\sigma}} \times (\bs{p}-e\bs{A})) \psi'_{\bs{R}} &= \alpha_R(\hat{\sigma_x}(\hat{p}_y-e\bs{A}) - \hat{\sigma_y}(\hat{p}_x-e\bs{A})) e^{i\frac{e}{\hbar}\int_{\bs{R}}^{\bs{r}}d\bs{r}'\bs{A}(\bs{r}',t)} \psi_{\bs{R}} = \\
  &= e^{i\frac{e}{\hbar}\int_{\bs{R}}^{\bs{r}}d\bs{r}'\bs{A}(\bs{r}',t)} \alpha_R \hat{z}\hat{\bs{\sigma}} \times \bs{p} \psi_{\bs{R}}
\end{align*}

Therefore relation \ref{PeierlsMtxElem} still holds.

\end{section}

\begin{section}{Identities}

Let $Z(t)$ be an operator dependent on the parameter $t$. Then:

\begin{align*}
d_t e^{Z} &= d_t \sum_{n=0}^\infty \frac{1}{n!} Z^n = \sum_{n=0}^\infty \sum_{m=0}^{n-1} \frac{1}{n!} Z^m \frac{\partial Z}{\partial t} Z^{n-m-1} = \\
&= \sum_{m=0}^\infty \sum_{p=0}^\infty \frac{1}{(m+p+1)!}Z^m \frac{\partial Z}{\partial t} Z^p = \sum_{m=0}^\infty \sum_{p=0}^\infty \frac{m!p!}{(m+p+1)!} \frac{Z^m}{m!} \frac{\partial Z}{\partial t} \frac{Z^p}{p!} =\\
&= \sum_{m=0}^\infty \sum_{p=0}^\infty \int_0^1 dx x^m (1-x)^p \frac{Z^m}{m!} \frac{\partial Z}{\partial t} \frac{Z^p}{p!} = \int_0^1 dx e^{Zx} \frac{\partial Z}{\partial t} e^{Z(1-x)} = \\
&= \int_0^1 dx \sum_{n=0}^\infty \frac{1}{n!} \left[xZ, \dots, \left[xZ, \frac{\partial Z}{\partial t}\right] \dots \right] e^Z = \sum_{n=0}^\infty \frac{1}{(n+1)!} \left[Z, \dots, \left[Z, \frac{\partial Z}{\partial t}\right] \dots \right] e^Z
\end{align*}

Where we used the Beta function $\int_0^1 dx x^m (1-x)^p = \frac{m!p!}{(m+p+1)!}$ and we also used the Baker–Campbell–Hausdorff expansion for $e^{xZ}\frac{\partial Z}{\partial t}e^{-xZ}$ and $\int_0^1 x^n = \frac{1}{n+1}$. Therefore we proved:

\begin{equation}
d_t e^{Z} = \sum_{n=0}^\infty \frac{1}{(n+1)!} \left[Z, \dots, \left[Z, \frac{\partial Z}{\partial t}\right] \dots \right] e^Z
\end{equation}

\end{section}

\end{subappendices}







